<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Register</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <div class="container">
    <div class="form-box">
      <h2 id="roleTitle">Register as Student</h2>

      <!-- Role Selection -->
      <select id="roleSelect" class="input">
        <option value="student">Student</option>
        <option value="professor">Professor</option>
        <option value="admin">Admin</option>
      </select>

      <!-- Registration Form -->
      <div id="registerForm">
        <input class="input" name="fullName" placeholder="Full Name" />

        <!-- Student Fields -->
        <div id="studentFields">
          <input class="input" name="studentID" placeholder="01-2345-567891" />
          <input class="input" name="course" placeholder="Course" />
          <input class="input" name="yearLevel" placeholder="Year Level" />
        </div>

        <!-- Professor Fields -->
        <div id="professorFields" style="display:none;">
          <input class="input" name="professorID" placeholder="P-12-3456-7890" />
        </div>

        <!-- Admin Fields -->
        <div id="adminFields" style="display:none;">
          <input class="input" name="adminID" placeholder="A-12-3456-7890" />
        </div>

        <input class="input" name="email" placeholder="Email" />
        <input class="input" name="password" type="password" placeholder="Password" />

        <button id="registerBtn" class="btn">Send OTP</button>
      </div>

      <!-- OTP Verification -->
      <div id="otpForm" style="display:none;">
        <input class="input" id="otpInput" placeholder="Enter OTP" />
        <button id="verifyBtn" class="btn">Verify Account</button>
      </div>
    </div>
  </div>

  <script>
  let role = "student";
  let form = {};

  const roleSelect = document.getElementById("roleSelect");
  const roleTitle = document.getElementById("roleTitle");

  const studentFields = document.getElementById("studentFields");
  const professorFields = document.getElementById("professorFields");
  const adminFields = document.getElementById("adminFields");

  const registerBtn = document.getElementById("registerBtn");

  // Handle Role Change
  roleSelect.addEventListener("change", (e) => {
    role = e.target.value;
    roleTitle.innerText = `Register as ${role.charAt(0).toUpperCase() + role.slice(1)}`;

    studentFields.style.display = role === "student" ? "block" : "none";
    professorFields.style.display = role === "professor" ? "block" : "none";
    adminFields.style.display = role === "admin" ? "block" : "none";
  });

  // Collect Form Data
  function collectFormData() {
    form = {};
    document.querySelectorAll("#registerForm .input").forEach(input => {
      if (input.name) form[input.name] = input.value;
    });
  }

  // Handle Register (no OTP)
  registerBtn.addEventListener("click", async () => {
    collectFormData();

    try {
      const res = await fetch(`http://localhost:8000/api/${role}/register-temp`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(form)
      });

      const data = await res.json();
      alert(data.msg || "User registered directly (no OTP)");

    } catch (err) {
      console.error(err);
      alert("Error during registration");
    }
  });
</script>

  </script>
</body>
</html>
